# ğŸ“Š LUá»’NG Tá»”NG QUAN: EMBEDDING PIPELINE VISUAL

## ğŸ¯ Má»¥c ÄÃ­ch

Hiá»ƒu **tá»« Ä‘áº§u Ä‘áº¿n cuá»‘i** quÃ¡ trÃ¬nh chuyá»ƒn PDF â†’ chunks â†’ embeddings â†’ lÆ°u DB

---

## ğŸ”„ FLOW LEVEL 1: BIG PICTURE (Cao Cáº¥p)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PDF FILE (document.pdf)                      â”‚
â”‚                     10 trang, 50KB                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              EXTRACTION (text_extractor.py)                      â”‚
â”‚                                                                  â”‚
â”‚  PdfReader Ä‘á»c PDF trang by trang                               â”‚
â”‚  TrÃ­ch text tá»« tá»«ng trang (bá» kÃ½ tá»± null, xÃ³a spaces)         â”‚
â”‚  âŒ Trang tráº¯ng hoáº·c null text â†’ bá» qua                         â”‚
â”‚                                                                  â”‚
â”‚  OUTPUT: 10 DocumentChunk objects                               â”‚
â”‚  - Chunk 1: "Trang 1 ná»™i dung..." (page_number=1)              â”‚
â”‚  - Chunk 2: "Trang 2 ná»™i dung..." (page_number=2)              â”‚
â”‚  - ...                                                          â”‚
â”‚  - Chunk 10: "Trang 10 ná»™i dung..." (page_number=10)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CHUNKING (chunker.py)                               â”‚
â”‚                                                                  â”‚
â”‚  RecursiveCharacterTextSplitter chia chunks dÃ i thÃ nh nhá»       â”‚
â”‚  - chunk_size = 900 kÃ½ tá»±                                       â”‚
â”‚  - chunk_overlap = 200 kÃ½ tá»±                                    â”‚
â”‚  - separators = ["\n\n", "\n", " ", ""]                         â”‚
â”‚                                                                  â”‚
â”‚  Trang 1 (1500 kÃ½ tá»±) â†’ 2 TextChunk                            â”‚
â”‚  Trang 2 (800 kÃ½ tá»±) â†’ 1 TextChunk                             â”‚
â”‚  Trang 3 (2000 kÃ½ tá»±) â†’ 3 TextChunk                            â”‚
â”‚  ...                                                             â”‚
â”‚                                                                  â”‚
â”‚  OUTPUT: 25 TextChunk objects (tá»•ng cá»™ng)                      â”‚
â”‚  - TextChunk 1: "..." (page=1, chunk_index=1)                  â”‚
â”‚  - TextChunk 2: "..." (page=1, chunk_index=2)                  â”‚
â”‚  - TextChunk 3: "..." (page=2, chunk_index=3)                  â”‚
â”‚  - ...                                                          â”‚
â”‚  - TextChunk 25: "..." (page=10, chunk_index=25)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              EMBEDDING (embedder.py)                             â”‚
â”‚                                                                  â”‚
â”‚  SentenceTransformer model sinh vector cho má»—i chunk            â”‚
â”‚  - Load model tá»« HuggingFace (láº§n Ä‘áº§u, ~500MB)                 â”‚
â”‚  - Batch encode táº¥t cáº£ texts                                    â”‚
â”‚  - Output: máº£ng 768-chiá»u cho má»—i chunk                         â”‚
â”‚                                                                  â”‚
â”‚  OUTPUT: 25 EmbeddingResult objects                             â”‚
â”‚  - Result 1: chunk="...", vector=[0.1, 0.2, ..., 0.3] (768)   â”‚
â”‚  - Result 2: chunk="...", vector=[0.4, 0.5, ..., 0.6] (768)   â”‚
â”‚  - ...                                                          â”‚
â”‚  - Result 25: chunk="...", vector=[...] (768)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DATABASE INSERTION (supabase_client.py)             â”‚
â”‚                                                                  â”‚
â”‚  XÃ³a embeddings cÅ© (náº¿u document re-process)                    â”‚
â”‚  Insert 25 records vÃ o table "document_embeddings"              â”‚
â”‚                                                                  â”‚
â”‚  Má»—i record:                                                    â”‚
â”‚  {                                                              â”‚
â”‚    document_id: "abc123",                                       â”‚
â”‚    page_number: 1,                                              â”‚
â”‚    chunk_index: 1,                                              â”‚
â”‚    content: "...",                                              â”‚
â”‚    embedding: [0.1, 0.2, ..., 0.3]  (768 chiá»u)               â”‚
â”‚  }                                                              â”‚
â”‚                                                                  â”‚
â”‚  OUTPUT: 25 rows á»Ÿ Supabase database                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  âœ… EMBEDDING DONE!                              â”‚
â”‚                                                                  â”‚
â”‚  Ready for RAG: similarity search + LLM generation              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ FLOW LEVEL 2: CHI TIáº¾T Tá»ªNG BÆ¯á»šC

### **BÆ¯á»šC 1: EXTRACTION - Äá»c PDF**

```
File: document.pdf

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Page 1       â”‚  â†’ extract_text() â†’ "LangChain lÃ  framework..."
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       (khoáº£ng 1000 kÃ½ tá»±)
â”‚ Page 2       â”‚  â†’ extract_text() â†’ "Embedding lÃ  vector..."
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       (khoáº£ng 800 kÃ½ tá»±)
â”‚ Page 3       â”‚  â†’ extract_text() â†’ "Supabase lÃ  database..."
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       (khoáº£ng 2000 kÃ½ tá»±)
â”‚ Page 4       â”‚  â†’ extract_text() â†’ "Vector similarity..."
â”‚ ... Page N   â”‚  â†’ ...
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FLOW:
1. PdfReader(file_path).pages
   â†“
2. for idx, page in enumerate(pages, start=1):
   â†“
3. page.extract_text()
   â†“
4. XÃ³a kÃ½ tá»± null + khoáº£ng tráº¯ng
   â†“
5. yield DocumentChunk(text, page_number=idx)

OUTPUT: Generator â†’ Iterable[DocumentChunk]
(KhÃ´ng load táº¥t cáº£ vÃ o memory, yield tá»«ng trang)
```

---

### **BÆ¯á»šC 2: CHUNKING - Chia Nhá»**

```
INPUT: DocumentChunk (trang)

LOGIC CHIA:

Trang 1 (1000 kÃ½ tá»±):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "LangChain lÃ  framework..."            â”‚ < 900 kÃ½ tá»±
â”‚ "NÃ³ cung cáº¥p cÃ´ng cá»¥..."              â”‚ 1000 > 900
â”‚ "RecursiveCharacterTextSplitter..."    â”‚ â†’ Cáº¦N CHIA!
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
Chia theo "\n\n" (paragraphs) â†’ 3 pháº§n
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Paragraph 1 (600)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Paragraph 2 (300)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Paragraph 3 (100)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
Táº¥t cáº£ < 900 â†’ KhÃ´ng chia tiáº¿p

OUTPUT:
- TextChunk 1: "LangChain lÃ  framework..." (600 kÃ½ tá»±, page=1, index=1)
- TextChunk 2: "..." (300 kÃ½ tá»±, page=1, index=2)
- TextChunk 3: "..." (100 kÃ½ tá»±, page=1, index=3)

---

Trang 3 (2000 kÃ½ tá»±):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "Supabase lÃ  database..."              â”‚ 2000 > 900
â”‚ "NÃ³ há»— trá»£ pgvector..."                â”‚ â†’ Cáº¦N CHIA!
â”‚ "Vector similarity search..."          â”‚
â”‚ "Embedding space..."                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
Chia theo "\n\n" â†’ 4 paragraphs
Táº¥t cáº£ váº«n > 900 â†’ Chia tiáº¿p theo "\n" (dÃ²ng)
         â”‚
         â–¼
Output: 3 TextChunk (má»—i ~700 kÃ½ tá»±, overlap 200)
- TextChunk n: "..." (700 kÃ½ tá»±, page=3, index=n)
- TextChunk n+1: "[overlap 200]..." (700 kÃ½ tá»±, page=3, index=n+1)
- TextChunk n+2: "[overlap 200]..." (600 kÃ½ tá»±, page=3, index=n+2)
```

---

### **BÆ¯á»šC 3: EMBEDDING - Sinh Vector**

```
INPUT: List[TextChunk]

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ TextChunk 1: "LangChain lÃ  framework..."            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TextChunk 2: "Embedding lÃ  vector..."               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TextChunk 3: "Supabase lÃ  database..."              â”‚
â”‚ ...                                                 â”‚
â”‚ TextChunk 25: "..."                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Load SentenceTransformer    â”‚
        â”‚ "paraphrase-multilingual"   â”‚
        â”‚ 768-dim model               â”‚
        â”‚ (download tá»« HuggingFace)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Batch encode:               â”‚
        â”‚ texts = [t1, t2, ..., t25]  â”‚
        â”‚ embeddings = model.encode   â”‚
        â”‚   (texts, show_progress)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        OUTPUT: numpy array (25, 768)
        
        [
          [0.123, 0.456, 0.789, ..., 0.234],  â† chunk 1 (768 chiá»u)
          [0.100, 0.200, 0.300, ..., 0.400],  â† chunk 2 (768 chiá»u)
          [0.512, 0.613, 0.714, ..., 0.815],  â† chunk 3 (768 chiá»u)
          ...
          [...],                               â† chunk 25
        ]
        
        Má»—i vector = semantic fingerprint cá»§a chunk
        Vector gáº§n nhau = text cÃ³ Ã½ nghÄ©a tÆ°Æ¡ng tá»±
```

---

### **BÆ¯á»šC 4: DATABASE INSERTION - LÆ°u Trá»¯**

```
INPUT: List[EmbeddingResult]
(25 objects, má»—i cÃ³ chunk + vector)

PREPARE RECORDS:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {                                                          â”‚
â”‚   "document_id": "abc123",        â† ID document gá»‘c      â”‚
â”‚   "page_number": 1,               â† Trang máº¥y             â”‚
â”‚   "chunk_index": 1,               â† Chunk thá»© máº¥y         â”‚
â”‚   "content": "LangChain lÃ ...",   â† Text ná»™i dung         â”‚
â”‚   "embedding": [0.123, 0.456, ..., 0.234]  â† 768 chiá»u  â”‚
â”‚ },                                                         â”‚
â”‚ {                                                          â”‚
â”‚   "document_id": "abc123",                                â”‚
â”‚   "page_number": 1,                                       â”‚
â”‚   "chunk_index": 2,                                       â”‚
â”‚   "content": "Embedding lÃ ...",                           â”‚
â”‚   "embedding": [0.100, 0.200, ..., 0.400]                â”‚
â”‚ },                                                         â”‚
â”‚ ...                                                        â”‚
â”‚ (25 records tá»•ng cá»™ng)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Supabase Client              â”‚
        â”‚ delete_existing_embeddings() â”‚
        â”‚ (xÃ³a cÅ© náº¿u re-process)      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ INSERT 25 records vÃ o        â”‚
        â”‚ document_embeddings table    â”‚
        â”‚                              â”‚
        â”‚ Supabase sáº½:                â”‚
        â”‚ 1. LÆ°u toÃ n bá»™ 25 rows     â”‚
        â”‚ 2. Index embedding vá»›i     â”‚
        â”‚    IVFFlat (pgvector)      â”‚
        â”‚ 3. Ready cho similarity    â”‚
        â”‚    search                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ âœ… DATABASE STATE:           â”‚
        â”‚                              â”‚
        â”‚ Table: document_embeddings   â”‚
        â”‚ - 25 rows                    â”‚
        â”‚ - document_id: abc123        â”‚
        â”‚ - pages: 1-10               â”‚
        â”‚ - chunks: 1-25              â”‚
        â”‚ - embeddings indexed         â”‚
        â”‚                              â”‚
        â”‚ Ready for RAG!              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š PIPELINE ARCHITECTURE DIAGRAM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PDF File       â”‚
â”‚  document.pdf    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (50KB)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  text_extractor.py                       â”‚
â”‚  â”œâ”€ PdfReader                            â”‚
â”‚  â”œâ”€ Extract pages (10)                   â”‚
â”‚  â”œâ”€ Clean text                           â”‚
â”‚  â””â”€ Yield DocumentChunk                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (10 DocumentChunk)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  chunker.py                              â”‚
â”‚  â”œâ”€ RecursiveCharacterTextSplitter       â”‚
â”‚  â”œâ”€ chunk_size=900, overlap=200          â”‚
â”‚  â”œâ”€ Split pages â†’ chunks                 â”‚
â”‚  â””â”€ Return List[TextChunk]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (25 TextChunk)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  embedder.py                             â”‚
â”‚  â”œâ”€ Load SentenceTransformer             â”‚
â”‚  â”œâ”€ Batch encode texts                   â”‚
â”‚  â””â”€ Return List[EmbeddingResult]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (25 EmbeddingResult: chunk+vector)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  pipeline.py                             â”‚
â”‚  â”œâ”€ Orchestrate flow                     â”‚
â”‚  â”œâ”€ Error handling                       â”‚
â”‚  â””â”€ Status tracking                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (prepared records)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  supabase_client.py                      â”‚
â”‚  â”œâ”€ Delete old embeddings                â”‚
â”‚  â”œâ”€ Insert new records                   â”‚
â”‚  â””â”€ Index with pgvector                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (25 rows inserted)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Supabase Database                       â”‚
â”‚  table: document_embeddings              â”‚
â”‚  â”œâ”€ document_id: abc123                  â”‚
â”‚  â”œâ”€ page_number: 1-10                    â”‚
â”‚  â”œâ”€ chunk_index: 1-25                    â”‚
â”‚  â”œâ”€ content: text                        â”‚
â”‚  â”œâ”€ embedding: [0.1, 0.2, ..., 0.3]    â”‚
â”‚  â”‚              (768 chiá»u, indexed)     â”‚
â”‚  â””â”€ âœ… READY FOR RAG                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’¡ TÃ“M Láº I

**Embedding Pipeline = QuÃ¡ trÃ¬nh biáº¿n PDF thÃ nh Vector Store**

```
PDF 
  â†“ (read + clean)
Text Pages 
  â†“ (split + overlap)
Chunks 
  â†“ (encode + 768-dim)
Vectors 
  â†“ (index + store)
Supabase Vector DB
  â†“ (ready for)
RAG System
```

**Báº¡n Ä‘Ã£ cÃ³:** âœ… Vector DB ready
**Tiáº¿p theo:** â³ Build RAG (retriever + LLM)

Báº¡n hiá»ƒu rÃµ hÆ¡n khÃ´ng? ğŸ‰
